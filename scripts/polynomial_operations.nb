(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65170,       1757]
NotebookOptionsPosition[     60297,       1667]
NotebookOutlinePosition[     60721,       1684]
CellTagsIndexPosition[     60678,       1681]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.907052155916052*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"f320c88e-d8d6-4f4e-9618-487c762222f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Linear2dTransformation", "[", 
   RowBox[{"m_", ",", "dd_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", " ", "=", " ", "m"}], ",", 
      RowBox[{"DD", " ", "=", " ", "dd"}], " ", ",", "monomials", ",", 
      "powers", ",", "x", ",", "y", ",", "z", ",", "\[Zeta]", ",", "change", 
      ",", "rulematrix", ",", "resultmatrix"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"monomials", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", 
             RowBox[{"j", "-", "i"}]], 
            SuperscriptBox["y", "i"]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "DD"}], "}"}]}], "]"}]}]}], ";", "\n", 
     "    ", 
     RowBox[{"powers", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"j", "-", "i"}], ",", "i"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", "DD"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\n", "    ", 
     RowBox[{"change", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "->", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"M", ".", 
            RowBox[{"{", 
             RowBox[{"z", ",", "\[Zeta]"}], "}"}]}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"y", "->", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"M", ".", 
            RowBox[{"{", 
             RowBox[{"z", ",", "\[Zeta]"}], "}"}]}], ")"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rulematrix", " ", "=", " ", 
      RowBox[{"CoefficientRules", "[", 
       RowBox[{
        RowBox[{"monomials", "/.", "change"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "\[Zeta]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"resultmatrix", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"powers", "/.", 
         RowBox[{"rulematrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "powers", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\n", "  ", 
     RowBox[{"resultmatrix", "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], "->", "0"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.90662182447711*^9, 3.9066218998946743`*^9}, {
   3.906623079369141*^9, 3.906623110303121*^9}, {3.906623181410276*^9, 
   3.906623185855156*^9}, {3.906623296428727*^9, 3.906623350043643*^9}, {
   3.906623387165449*^9, 3.90662345321595*^9}, 3.906623506876761*^9, {
   3.906623552913561*^9, 3.906623865230464*^9}, {3.906623898285429*^9, 
   3.9066238986998253`*^9}, {3.906623929296537*^9, 3.906623966581869*^9}, {
   3.906624117989544*^9, 3.906624181675058*^9}, {3.906624231477066*^9, 
   3.906624259041007*^9}, {3.906624557141964*^9, 3.9066245656719923`*^9}, {
   3.906624791383288*^9, 3.906624829548661*^9}, {3.906718708089698*^9, 
   3.9067187305340033`*^9}, {3.906718833315496*^9, 3.9067188359097757`*^9}, {
   3.9070521411473427`*^9, 3.907052190391501*^9}, {3.907052238816514*^9, 
   3.907052281787387*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"53d58c83-074b-4168-bfda-b40f32478424"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"W", "=", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    SubscriptBox["w", 
     RowBox[{"1", ",", "0"}]], ",", 
    SubscriptBox["w", 
     RowBox[{"0", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.907053212341742*^9, 3.907053261725429*^9}, {
  3.907053350142017*^9, 3.907053367606494*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"0479bdf3-0bfc-40ca-9cf6-cdcea6151eaf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   SubscriptBox["w", 
    RowBox[{"1", ",", "0"}]], ",", 
   SubscriptBox["w", 
    RowBox[{"0", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",\

 CellChangeTimes->{{3.907053220517015*^9, 3.9070532621942787`*^9}, 
   3.907053368273346*^9, 3.907053723260168*^9, 3.9070537710898857`*^9, 
   3.907053807517658*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"45a39176-5e52-49c6-9adc-e7c17d0baeca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R", "=", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    SubscriptBox["r", 
     RowBox[{"1", ",", "0"}]], ",", 
    SubscriptBox["r", 
     RowBox[{"0", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.9070532682565727`*^9, 3.907053271019834*^9}, {
  3.907053373269899*^9, 3.907053380749954*^9}, {3.907053835356996*^9, 
  3.907053847765864*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"f0003a0c-d71e-454e-9254-bb7311eef858"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   SubscriptBox["r", 
    RowBox[{"1", ",", "0"}]], ",", 
   SubscriptBox["r", 
    RowBox[{"0", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",\

 CellChangeTimes->{3.907053271320816*^9, 3.9070533813649473`*^9, 
  3.9070537232912207`*^9, 3.9070537711212273`*^9, 3.907053808592741*^9, 
  3.907053850045268*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"f36ef041-8775-4b64-be9e-74dd9649ca6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", "=", 
  RowBox[{"{", 
   RowBox[{"W", ",", "R"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.907053782859417*^9, 3.907053786324445*^9}, {
  3.9070538536855173`*^9, 3.907053853965667*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"7077230e-3bf5-4285-b8a3-36cf0a6abe87"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SubscriptBox["w", 
      RowBox[{"1", ",", "0"}]], ",", 
     SubscriptBox["w", 
      RowBox[{"0", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SubscriptBox["r", 
      RowBox[{"1", ",", "0"}]], ",", 
     SubscriptBox["r", 
      RowBox[{"0", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.907053787801392*^9, 3.90705380975383*^9}, 
   3.907053854603916*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"62659b74-df7a-4bc5-8153-047657b3ce13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["a", 
      RowBox[{"i", ",", "j"}]], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.906450900697063*^9, 3.906450911465629*^9}, {
   3.9064539108446627`*^9, 3.906453917049567*^9}, 3.906456736871421*^9, {
   3.90645949287843*^9, 3.906459497326262*^9}, {3.906460600698393*^9, 
   3.906460608096023*^9}, {3.906609251715564*^9, 3.906609255317617*^9}, {
   3.906609326045327*^9, 3.9066093263688717`*^9}, {3.906609395078104*^9, 
   3.906609397187647*^9}, {3.906609780930615*^9, 3.906609786167284*^9}, {
   3.906609873733698*^9, 3.906609923797674*^9}, {3.9066099663500967`*^9, 
   3.9066099794900513`*^9}, {3.90661002841413*^9, 3.9066100308245163`*^9}, {
   3.9066113799678173`*^9, 3.90661142969495*^9}, {3.906611470896862*^9, 
   3.9066115092859383`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"692d97ec-ed31-4fd9-b0f8-13d766036e8d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["a", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["a", 
       RowBox[{"1", ",", "2"}]]},
     {
      SubscriptBox["a", 
       RowBox[{"2", ",", "1"}]], 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.906624278106203*^9, 3.906624541255291*^9, 3.9066245719959707`*^9, 
   3.906624797805027*^9, {3.906624833274374*^9, 3.906624835455318*^9}, 
   3.906717767403501*^9, 3.906717855538834*^9, {3.906717899654962*^9, 
   3.906717928711892*^9}, {3.9067181759033947`*^9, 3.906718199605495*^9}, 
   3.906718269322439*^9, 3.906718737335668*^9, 3.906718838329825*^9, 
   3.9067188992200327`*^9, 3.906781879268736*^9, 3.907052158458332*^9, 
   3.90705229037066*^9, 3.907053723317872*^9, 3.907053771150776*^9},
 CellLabel->
  "Out[5]//MatrixForm=",ExpressionUUID->"2cfd4c50-9e04-4633-bf2c-\
08ebd4fdb136"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"M", " ", "=", 
   RowBox[{"Linear2dTransformation", "[", 
    RowBox[{"A", ",", "2"}], "]"}]}], ";", 
  RowBox[{"M", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.9066242854422407`*^9, 3.906624320080441*^9}, {
   3.906624358192087*^9, 3.906624361471036*^9}, {3.906624842192313*^9, 
   3.90662484233074*^9}, 3.906781877541363*^9, {3.907052293922873*^9, 
   3.9070522969946957`*^9}, {3.907052345683976*^9, 3.907052347515231*^9}, 
   3.907052379700354*^9, 3.90705341909057*^9, {3.907053463640436*^9, 
   3.9070534646671886`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"1d7a7464-2bb5-4331-bad1-b18f36f3fd4f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0"},
     {"0", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["a", 
       RowBox[{"1", ",", "2"}]], "0", "0", "0"},
     {"0", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "1"}]], 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]], "0", "0", "0"},
     {"0", "0", "0", 
      SubsuperscriptBox["a", 
       RowBox[{"1", ",", "1"}], "2"], 
      RowBox[{"2", " ", 
       SubscriptBox["a", 
        RowBox[{"1", ",", "1"}]], " ", 
       SubscriptBox["a", 
        RowBox[{"1", ",", "2"}]]}], 
      SubsuperscriptBox["a", 
       RowBox[{"1", ",", "2"}], "2"]},
     {"0", "0", "0", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "1"}]], " ", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "1"}]]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"1", ",", "2"}]], " ", 
        SubscriptBox["a", 
         RowBox[{"2", ",", "1"}]]}], "+", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"1", ",", "1"}]], " ", 
        SubscriptBox["a", 
         RowBox[{"2", ",", "2"}]]}]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "2"}]], " ", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "2"}]]}]},
     {"0", "0", "0", 
      SubsuperscriptBox["a", 
       RowBox[{"2", ",", "1"}], "2"], 
      RowBox[{"2", " ", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "1"}]], " ", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "2"}]]}], 
      SubsuperscriptBox["a", 
       RowBox[{"2", ",", "2"}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.907052297483952*^9, 3.9070523481229143`*^9, 
  3.907052379991493*^9, 3.90705341975462*^9, 3.907053465098956*^9, 
  3.907053723420529*^9, 3.907053771181014*^9},
 CellLabel->
  "Out[6]//MatrixForm=",ExpressionUUID->"0aafd088-9ca4-4a6c-833f-\
9f1cc1c527cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", ".", 
     RowBox[{"Transpose", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
  "B"}]], "Input",
 CellChangeTimes->{{3.9070534258563423`*^9, 3.907053444189353*^9}, {
   3.907053681748797*^9, 3.907053689298532*^9}, 3.907053740280038*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"8bcfb3d5-3533-4f50-94cd-75aa7642369e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "2"}]], " ", 
       SubscriptBox["w", 
        RowBox[{"0", ",", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "1"}]], " ", 
       SubscriptBox["w", 
        RowBox[{"1", ",", "0"}]]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "2"}]], " ", 
       SubscriptBox["w", 
        RowBox[{"0", ",", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "1"}]], " ", 
       SubscriptBox["w", 
        RowBox[{"1", ",", "0"}]]}]}], ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "2"}]], " ", 
       SubscriptBox["r", 
        RowBox[{"0", ",", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "1"}]], " ", 
       SubscriptBox["r", 
        RowBox[{"1", ",", "0"}]]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "2"}]], " ", 
       SubscriptBox["r", 
        RowBox[{"0", ",", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "1"}]], " ", 
       SubscriptBox["r", 
        RowBox[{"1", ",", "0"}]]}]}], ",", "0", ",", "0", ",", "0"}], "}"}]}],
   "}"}]], "Output",
 CellChangeTimes->{{3.907053455060639*^9, 3.907053469024263*^9}, {
   3.907053683078471*^9, 3.907053689774703*^9}, {3.907053723479765*^9, 
   3.907053771209544*^9}, 3.907053876504039*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"6160cfb0-2807-42bc-ba52-86ddd7837599"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Inverse", "[", "A", "]"}], "."}]], "Input",
 CellChangeTimes->{{3.90705366851343*^9, 3.907053673584549*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->"In[8]:=",ExpressionUUID->"21d45db0-29ec-4034-8d0c-2b1c3014511d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NearIdentity2dTransformation", "[", 
   RowBox[{"h1_", ",", "h2_", ",", "dd_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H1", "=", "h1"}], ",", 
      RowBox[{"H2", "=", "h2"}], ",", 
      RowBox[{"DD", " ", "=", " ", "dd"}], " ", ",", "monomials", ",", 
      "polynomialH", ",", "NN", ",", "powers", ",", "x", ",", "y", ",", "z", 
      ",", "\[Zeta]", ",", "change", ",", "rulematrix", ",", "powermatrix", 
      ",", "R"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"monomials", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", 
             RowBox[{"j", "-", "i"}]], 
            SuperscriptBox["y", "i"]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "DD"}], "}"}]}], "]"}]}]}], ";", "\n", 
     "    ", 
     RowBox[{"powers", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"j", "-", "i"}], ",", "i"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", "DD"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NN", " ", "=", 
      RowBox[{"Length", "[", "powers", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"change", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "->", 
         RowBox[{"z", " ", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"H1", "~", "Join", "~", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"NN", "-", 
                RowBox[{"Length", "[", "H1", "]"}]}]}], "]"}]}], ")"}], ".", 
           RowBox[{"monomials", "[", 
            RowBox[{"z", ",", "\[Zeta]"}], "]"}]}]}]}], " ", ",", 
        RowBox[{"y", "->", 
         RowBox[{"\[Zeta]", " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"H2", "~", "Join", "~", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"NN", "-", 
                RowBox[{"Length", "[", "H2", "]"}]}]}], "]"}]}], ")"}], ".", 
           RowBox[{"monomials", "[", 
            RowBox[{"z", ",", "\[Zeta]"}], "]"}]}]}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rulematrix", " ", "=", " ", 
      RowBox[{"CoefficientRules", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"monomials", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "/.", "change"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "\[Zeta]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"powermatrix", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"powers", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "powers", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\n", "     ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "powers", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"powermatrix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"powermatrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"rulematrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", " ", "=", 
      RowBox[{
       RowBox[{"Transpose", "@", "powermatrix"}], "/.", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "j_"}], "}"}], "->", "0"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "R"}], "}"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.906624912585733*^9, 3.90662492580859*^9}, {
   3.906627753657852*^9, 3.9066278546060658`*^9}, {3.906627884745791*^9, 
   3.9066278938635406`*^9}, {3.906633668368142*^9, 3.906633676270864*^9}, {
   3.906634273183217*^9, 3.906634279609056*^9}, 3.9066348948963614`*^9, 
   3.9066349457217913`*^9, {3.906635069051862*^9, 3.9066350769727373`*^9}, {
   3.906635133273971*^9, 3.906635230552555*^9}, {3.906717646919528*^9, 
   3.9067177598391848`*^9}, {3.9067178484905853`*^9, 
   3.9067178537288303`*^9}, {3.9067178853443108`*^9, 
   3.9067179265072613`*^9}, {3.9067179702989407`*^9, 3.906718208229809*^9}, {
   3.906718238805458*^9, 3.906718267479271*^9}, {3.906718869459485*^9, 
   3.906718875898158*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"769c0c50-5a1d-4015-89f8-4f10474249b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F", " ", "=", " ", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", ">=", "2"}], ",", 
         SubscriptBox["f", 
          RowBox[{
           RowBox[{"j", "-", "i"}], ",", "i"}]], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.906450900697063*^9, 3.906450911465629*^9}, {
   3.9064539108446627`*^9, 3.906453917049567*^9}, 3.906456736871421*^9, {
   3.90645949287843*^9, 3.906459497326262*^9}, {3.906460600698393*^9, 
   3.906460608096023*^9}, {3.906609251715564*^9, 3.906609255317617*^9}, {
   3.906609326045327*^9, 3.9066093263688717`*^9}, {3.906609395078104*^9, 
   3.906609397187647*^9}, {3.906609780930615*^9, 3.906609786167284*^9}, {
   3.906609873733698*^9, 3.906609923797674*^9}, {3.9066099663500967`*^9, 
   3.9066099794900513`*^9}, {3.90661002841413*^9, 3.9066100308245163`*^9}, {
   3.9066171613359003`*^9, 3.906617186541728*^9}, {3.9066174966938257`*^9, 
   3.906617496829792*^9}, {3.906617531957543*^9, 3.9066175451522493`*^9}, {
   3.906634174237927*^9, 3.906634202738329*^9}, {3.9067186505323477`*^9, 
   3.9067186528251877`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"f344116c-4333-4b95-a7e9-9616553cc8d2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", 
   SubscriptBox["f", 
    RowBox[{"2", ",", "0"}]], ",", 
   SubscriptBox["f", 
    RowBox[{"1", ",", "1"}]], ",", 
   SubscriptBox["f", 
    RowBox[{"0", ",", "2"}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.906450912591017*^9, 3.906453733208699*^9, {3.9064539139797907`*^9, 
   3.906453917610929*^9}, 3.906456571030553*^9, 3.9064567452713346`*^9, 
   3.9064586173729563`*^9, 3.906459427420656*^9, 3.9064594979800997`*^9, 
   3.906460608909091*^9, {3.906609256567987*^9, 3.90660926758249*^9}, 
   3.9066093269127493`*^9, 3.9066093999428263`*^9, 3.906609506664075*^9, 
   3.906609786503223*^9, {3.906609880750513*^9, 3.906609889591949*^9}, 
   3.9066099241899853`*^9, {3.9066099676875467`*^9, 3.906609980350246*^9}, 
   3.906610031227817*^9, 3.906610389839857*^9, 3.906611206651928*^9, {
   3.906613720850301*^9, 3.906613772025749*^9}, 3.90661382122687*^9, {
   3.906617187370479*^9, 3.906617236809587*^9}, {3.906617279176011*^9, 
   3.906617329657476*^9}, {3.9066175764603577`*^9, 3.906617611141926*^9}, {
   3.906617994979542*^9, 3.906618024838777*^9}, 3.906620225335985*^9, 
   3.906620267554208*^9, 3.9066205179947433`*^9, {3.906634166397942*^9, 
   3.906634203755743*^9}, 3.906635081268023*^9, {3.906635208946287*^9, 
   3.9066352386841497`*^9}, 3.906717767459752*^9, 3.906717855613408*^9, {
   3.9067178997422867`*^9, 3.906717928788946*^9}, {3.906718175977646*^9, 
   3.906718199679213*^9}, 3.9067182694008503`*^9, 3.906718656811591*^9, 
   3.906718737536448*^9, 3.906718838408161*^9, 3.906718899304693*^9, 
   3.9067818793306503`*^9, 3.907052158513032*^9, 3.9070537235806723`*^9, 
   3.907053771335498*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"f149123c-7ce4-44ee-9f98-84f026be7944"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"G", " ", "=", " ", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", ">=", "2"}], ",", 
         SubscriptBox["g", 
          RowBox[{
           RowBox[{"j", "-", "i"}], ",", "i"}]], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.906450900697063*^9, 3.906450911465629*^9}, {
   3.9064539108446627`*^9, 3.906453917049567*^9}, 3.906456736871421*^9, {
   3.90645949287843*^9, 3.906459497326262*^9}, {3.906460600698393*^9, 
   3.906460608096023*^9}, {3.906609251715564*^9, 3.906609255317617*^9}, {
   3.906609326045327*^9, 3.9066093263688717`*^9}, {3.906609395078104*^9, 
   3.906609397187647*^9}, {3.906609780930615*^9, 3.906609786167284*^9}, {
   3.906609873733698*^9, 3.906609923797674*^9}, {3.9066099663500967`*^9, 
   3.9066099794900513`*^9}, {3.90661002841413*^9, 3.9066100308245163`*^9}, {
   3.906613358756278*^9, 3.9066133738131647`*^9}, 3.906617200226283*^9, {
   3.906617499530444*^9, 3.90661749971938*^9}, 3.906617556089533*^9, {
   3.906634212505847*^9, 3.906634216931632*^9}, {3.906718654409952*^9, 
   3.906718654554428*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"bf14ddb5-256c-4b2f-8efc-5a46adeacdd3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", 
   SubscriptBox["g", 
    RowBox[{"2", ",", "0"}]], ",", 
   SubscriptBox["g", 
    RowBox[{"1", ",", "1"}]], ",", 
   SubscriptBox["g", 
    RowBox[{"0", ",", "2"}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.906450912591017*^9, 3.906453733208699*^9, {3.9064539139797907`*^9, 
   3.906453917610929*^9}, 3.906456571030553*^9, 3.9064567452713346`*^9, 
   3.9064586173729563`*^9, 3.906459427420656*^9, 3.9064594979800997`*^9, 
   3.906460608909091*^9, {3.906609256567987*^9, 3.90660926758249*^9}, 
   3.9066093269127493`*^9, 3.9066093999428263`*^9, 3.906609506664075*^9, 
   3.906609786503223*^9, {3.906609880750513*^9, 3.906609889591949*^9}, 
   3.9066099241899853`*^9, {3.9066099676875467`*^9, 3.906609980350246*^9}, 
   3.906610031227817*^9, 3.906610389839857*^9, 3.906611206651928*^9, {
   3.906613361926086*^9, 3.906613374927553*^9}, {3.906613720882576*^9, 
   3.9066137720376596`*^9}, 3.9066138212600203`*^9, {3.906617215644128*^9, 
   3.906617236843624*^9}, {3.906617279217867*^9, 3.906617329691691*^9}, {
   3.9066175764972982`*^9, 3.906617611173707*^9}, {3.9066179950126047`*^9, 
   3.9066180248704233`*^9}, 3.906620225367837*^9, 3.906620267592966*^9, 
   3.906620518028521*^9, 3.906634169118051*^9, 3.906634217400846*^9, 
   3.906635082433442*^9, 3.906635210092195*^9, 3.906635240387673*^9, 
   3.906717767475642*^9, 3.9067178556369762`*^9, {3.906717899768386*^9, 
   3.906717928812929*^9}, {3.9067181760019007`*^9, 3.906718199699223*^9}, 
   3.9067182694243727`*^9, 3.906718657933215*^9, 3.906718737568674*^9, 
   3.906718838429681*^9, 3.906718899326765*^9, 3.906781879361568*^9, 
   3.907052158574213*^9, 3.907053723605631*^9, 3.9070537713564777`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"01e2ff08-1e4b-46cd-996d-dbf9b13b572c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NearIdentity2dTransformation", "[", 
    RowBox[{"F", ",", "G", ",", "4"}], "]"}], "//", "MatrixForm"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9066346476604958`*^9, 3.9066346532093477`*^9}, {
   3.9066346840544233`*^9, 3.906634684199525*^9}, {3.9066352453103657`*^9, 
   3.906635246636705*^9}, {3.906717784774723*^9, 3.906717784999123*^9}, {
   3.90671817113211*^9, 3.90671817451996*^9}, 3.906781873335003*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"c1bcc6e7-0208-4036-9f2a-ddab39a27848"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Derivative", "[", 
   RowBox[{"l1_", ",", "l2_", ",", "dd_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"L1", "=", "l1"}], ",", 
      RowBox[{"L2", "=", "l2"}], ",", ",", 
      RowBox[{"DD", "=", "dd"}], ",", "monomials", ",", "powers", ",", "x", 
      ",", "y", ",", "NN", ",", "rulematrix", ",", "powermatrix"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"monomials", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", 
             RowBox[{"j", "-", "i"}]], 
            SuperscriptBox["y", "i"]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "DD"}], "}"}]}], "]"}]}]}], ";", "\n", 
     "    ", 
     RowBox[{"powers", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"j", "-", "i"}], ",", "i"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", "DD"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NN", " ", "=", 
      RowBox[{"Length", "[", "powers", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rulematrix", " ", "=", " ", 
      RowBox[{"CoefficientRules", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"monomials", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "L1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "L2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"powermatrix", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"powers", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "powers", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\n", "     ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "powers", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"powermatrix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"powermatrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"rulematrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Transpose", "@", "powermatrix"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], "->", "0"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.906781847013826*^9, 3.906781995252399*^9}, {
  3.9067820846930523`*^9, 3.90678211184728*^9}, {3.90678215549513*^9, 
  3.906782199564456*^9}, {3.906782255829863*^9, 3.90678229590371*^9}, {
  3.906782327857504*^9, 3.90678234132373*^9}, {3.906783144575234*^9, 
  3.9067831465515327`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"e87f3aea-7228-4643-b197-31220cd2af8a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["D", 
    RowBox[{"1", ",", "0"}]], "=", 
   RowBox[{"Derivative", "[", 
    RowBox[{"1", ",", "0", ",", "3"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["D", 
    RowBox[{"1", ",", "0"}]], "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.906782346991342*^9, 3.906782409531969*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"3cc4418d-d5d2-4b46-a2ca-88152cef8054"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "2", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "3", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "2", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.906782375815892*^9, 3.906782410130948*^9}, 
   3.9067831535007277`*^9, 3.907052158649488*^9, 3.907053723651115*^9, 
   3.907053771402423*^9},
 CellLabel->
  "Out[13]//MatrixForm=",ExpressionUUID->"57dd4135-02ce-4074-ac0a-\
deafc2be7124"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{
   SubscriptBox["D", 
    RowBox[{"1", ",", "0"}]], ".", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{
          RowBox[{"j", "-", "i"}], ",", "i"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9067824126308823`*^9, 3.906782432271587*^9}, {
  3.906782540719925*^9, 3.906782567687467*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"d7ffaad1-6a90-4ce6-bafb-cdb4d90cba4a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["p", 
    RowBox[{"1", ",", "0"}]], ",", 
   RowBox[{"2", " ", 
    SubscriptBox["p", 
     RowBox[{"2", ",", "0"}]]}], ",", 
   SubscriptBox["p", 
    RowBox[{"1", ",", "1"}]], ",", 
   RowBox[{"3", " ", 
    SubscriptBox["p", 
     RowBox[{"3", ",", "0"}]]}], ",", 
   RowBox[{"2", " ", 
    SubscriptBox["p", 
     RowBox[{"2", ",", "1"}]]}], ",", 
   SubscriptBox["p", 
    RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.906782432942486*^9, {3.906782555493876*^9, 3.906782568721877*^9}, 
   3.906783154952559*^9, 3.9070521586703653`*^9, 3.907053723673875*^9, 
   3.907053771424776*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"222b9007-0318-4b44-8e74-3d8c389604ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P", ".", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         RowBox[{"j", "-", "i"}]], 
        SuperscriptBox["y", "i"]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.906782572513124*^9, 3.906782583841649*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"bc8982be-f576-4282-a0a8-0359b6ccdd97"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["p", 
   RowBox[{"1", ",", "0"}]], "+", 
  RowBox[{"y", " ", 
   SubscriptBox["p", 
    RowBox[{"1", ",", "1"}]]}], "+", 
  RowBox[{
   SuperscriptBox["y", "2"], " ", 
   SubscriptBox["p", 
    RowBox[{"1", ",", "2"}]]}], "+", 
  RowBox[{"2", " ", "x", " ", 
   SubscriptBox["p", 
    RowBox[{"2", ",", "0"}]]}], "+", 
  RowBox[{"2", " ", "x", " ", "y", " ", 
   SubscriptBox["p", 
    RowBox[{"2", ",", "1"}]]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["x", "2"], " ", 
   SubscriptBox["p", 
    RowBox[{"3", ",", "0"}]]}]}]], "Output",
 CellChangeTimes->{3.906782584127496*^9, 3.90678315587641*^9, 
  3.907052158693218*^9, 3.9070537236990767`*^9, 3.907053771447014*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"a79eab05-af76-424f-b6bf-5722963949af"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Multiplication", "[", 
   RowBox[{"h_", ",", "dd_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H", "=", "h"}], ",", 
      RowBox[{"DD", "=", "dd"}], ",", "monomials", ",", "powers", ",", "NN", 
      ",", "x", ",", "y", ",", "rulematrix", ",", "powermatrix"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"monomials", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", 
             RowBox[{"j", "-", "i"}]], 
            SuperscriptBox["y", "i"]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "DD"}], "}"}]}], "]"}]}]}], ";", "\n", 
     "    ", 
     RowBox[{"powers", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"j", "-", "i"}], ",", "i"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", "DD"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NN", " ", "=", 
      RowBox[{"Length", "[", "powers", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rulematrix", " ", "=", " ", 
      RowBox[{"CoefficientRules", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"H", "~", "Join", "~", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"NN", "-", 
                RowBox[{"Length", "[", "H", "]"}]}]}], "]"}]}], ")"}], ".", 
           RowBox[{"monomials", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], ")"}], 
         RowBox[{"monomials", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"powermatrix", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"powers", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "powers", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\n", "     ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "powers", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"powermatrix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"powermatrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"rulematrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Transpose", "@", "powermatrix"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], "->", "0"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.906783020036727*^9, 3.906783084167259*^9}, 
   3.906783127585438*^9, {3.906783168019943*^9, 3.906783226557077*^9}, {
   3.906783318241974*^9, 3.906783319012361*^9}, {3.90678344002182*^9, 
   3.906783464274415*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"c2dedfd9-c269-4df4-a48b-2c145af22d2f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q", "=", 
  RowBox[{
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["q", 
         RowBox[{
          RowBox[{"j", "-", "i"}], ",", "i"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "~", "Join", "~", 
   
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "9"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9067824126308823`*^9, 3.906782432271587*^9}, {
   3.906782540719925*^9, 3.906782567687467*^9}, {3.906783256194083*^9, 
   3.906783264478972*^9}, {3.906783376023149*^9, 3.906783376144826*^9}, {
   3.906783472602323*^9, 3.906783472692183*^9}, 3.906783594496649*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"85692d06-13e1-455c-bf3f-355fccf9e5a3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["q", 
    RowBox[{"0", ",", "0"}]], ",", 
   SubscriptBox["q", 
    RowBox[{"1", ",", "0"}]], ",", 
   SubscriptBox["q", 
    RowBox[{"0", ",", "1"}]], ",", 
   SubscriptBox["q", 
    RowBox[{"2", ",", "0"}]], ",", 
   SubscriptBox["q", 
    RowBox[{"1", ",", "1"}]], ",", 
   SubscriptBox["q", 
    RowBox[{"0", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.906782432942486*^9, {3.906782555493876*^9, 3.906782568721877*^9}, 
   3.906783154952559*^9, 3.906783265667533*^9, 3.9067833766580143`*^9, 
   3.906783473158656*^9, 3.906783595688137*^9, 3.907052158725149*^9, 
   3.907053723775155*^9, 3.907053771479867*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"6f438dff-c062-4d74-9323-6b1beb5ff0c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "=", 
  RowBox[{
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["s", 
         RowBox[{
          RowBox[{"j", "-", "i"}], ",", "i"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "~", "Join", "~", 
   
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "9"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.906782572513124*^9, 3.906782583841649*^9}, {
  3.906783274781636*^9, 3.906783288915946*^9}, {3.906783544947611*^9, 
  3.906783579159067*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"04f70a76-38f3-4c45-91fa-405d69412231"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["s", 
    RowBox[{"0", ",", "0"}]], ",", 
   SubscriptBox["s", 
    RowBox[{"1", ",", "0"}]], ",", 
   SubscriptBox["s", 
    RowBox[{"0", ",", "1"}]], ",", 
   SubscriptBox["s", 
    RowBox[{"2", ",", "0"}]], ",", 
   SubscriptBox["s", 
    RowBox[{"1", ",", "1"}]], ",", 
   SubscriptBox["s", 
    RowBox[{"0", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.906782584127496*^9, 3.90678315587641*^9, 
  3.906783289712207*^9, 3.906783475937376*^9, 3.90678358326075*^9, 
  3.907052158744919*^9, 3.9070537237996683`*^9, 3.9070537715019484`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"8a56feec-1c57-44da-b783-15dede25107a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["M", "Q"], "=", 
   RowBox[{"Multiplication", "[", 
    RowBox[{"Q", ",", "4"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["M", "Q"], "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.906783303169785*^9, 3.9067833313270597`*^9}, {
  3.906783368511013*^9, 3.906783368631405*^9}, {3.906783519900017*^9, 
  3.906783520014989*^9}, {3.9067836004821177`*^9, 3.9067836536841288`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"c9d92738-841c-4f60-ba54-1dae7a0c7eb0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {
      SubscriptBox["q", 
       RowBox[{"1", ",", "0"}]], 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      SubscriptBox["q", 
       RowBox[{"0", ",", "1"}]], "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {
      SubscriptBox["q", 
       RowBox[{"2", ",", "0"}]], 
      SubscriptBox["q", 
       RowBox[{"1", ",", "0"}]], "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {
      SubscriptBox["q", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["q", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["q", 
       RowBox[{"1", ",", "0"}]], "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {
      SubscriptBox["q", 
       RowBox[{"0", ",", "2"}]], "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "1"}]], "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", 
      SubscriptBox["q", 
       RowBox[{"2", ",", "0"}]], "0", 
      SubscriptBox["q", 
       RowBox[{"1", ",", "0"}]], "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      SubscriptBox["q", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["q", 
       RowBox[{"2", ",", "0"}]], 
      SubscriptBox["q", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["q", 
       RowBox[{"1", ",", "0"}]], "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "2"}]], 
      SubscriptBox["q", 
       RowBox[{"1", ",", "1"}]], "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["q", 
       RowBox[{"1", ",", "0"}]], "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "2"}]], "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "1"}]], "0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"2", ",", "0"}]], "0", "0", 
      SubscriptBox["q", 
       RowBox[{"1", ",", "0"}]], "0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0"},
     {"0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["q", 
       RowBox[{"2", ",", "0"}]], "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["q", 
       RowBox[{"1", ",", "0"}]], "0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0"},
     {"0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "2"}]], 
      SubscriptBox["q", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["q", 
       RowBox[{"2", ",", "0"}]], "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["q", 
       RowBox[{"1", ",", "0"}]], "0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0", "0"},
     {"0", "0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "2"}]], 
      SubscriptBox["q", 
       RowBox[{"1", ",", "1"}]], "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["q", 
       RowBox[{"1", ",", "0"}]], "0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]], "0"},
     {"0", "0", "0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "2"}]], "0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "1"}]], "0", "0", "0", "0", 
      SubscriptBox["q", 
       RowBox[{"0", ",", "0"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.906783331721093*^9, {3.906783369264876*^9, 3.9067833800597477`*^9}, 
   3.906783479726467*^9, 3.906783520500166*^9, {3.906783604592463*^9, 
   3.906783654373578*^9}, 3.9070521587675543`*^9, 3.90705372382653*^9, 
   3.907053771526672*^9},
 CellLabel->
  "Out[19]//MatrixForm=",ExpressionUUID->"97e9e831-4a22-40ef-bb2b-\
99969cf52429"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["M", "S"], "=", 
   RowBox[{"Multiplication", "[", 
    RowBox[{"S", ",", "4"}], "]"}]}], ";", 
  RowBox[{
   SubscriptBox["M", "S"], "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.906783661675582*^9, 3.9067836667933292`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"5e18b2d3-61d2-4d2e-8edf-945b11f8ec0d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {
      SubscriptBox["s", 
       RowBox[{"1", ",", "0"}]], 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      SubscriptBox["s", 
       RowBox[{"0", ",", "1"}]], "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {
      SubscriptBox["s", 
       RowBox[{"2", ",", "0"}]], 
      SubscriptBox["s", 
       RowBox[{"1", ",", "0"}]], "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {
      SubscriptBox["s", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["s", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["s", 
       RowBox[{"1", ",", "0"}]], "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {
      SubscriptBox["s", 
       RowBox[{"0", ",", "2"}]], "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "1"}]], "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", 
      SubscriptBox["s", 
       RowBox[{"2", ",", "0"}]], "0", 
      SubscriptBox["s", 
       RowBox[{"1", ",", "0"}]], "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      SubscriptBox["s", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["s", 
       RowBox[{"2", ",", "0"}]], 
      SubscriptBox["s", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["s", 
       RowBox[{"1", ",", "0"}]], "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "2"}]], 
      SubscriptBox["s", 
       RowBox[{"1", ",", "1"}]], "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["s", 
       RowBox[{"1", ",", "0"}]], "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "2"}]], "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "1"}]], "0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"2", ",", "0"}]], "0", "0", 
      SubscriptBox["s", 
       RowBox[{"1", ",", "0"}]], "0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0", "0"},
     {"0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["s", 
       RowBox[{"2", ",", "0"}]], "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["s", 
       RowBox[{"1", ",", "0"}]], "0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0", "0"},
     {"0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "2"}]], 
      SubscriptBox["s", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["s", 
       RowBox[{"2", ",", "0"}]], "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["s", 
       RowBox[{"1", ",", "0"}]], "0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0", "0"},
     {"0", "0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "2"}]], 
      SubscriptBox["s", 
       RowBox[{"1", ",", "1"}]], "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "1"}]], 
      SubscriptBox["s", 
       RowBox[{"1", ",", "0"}]], "0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]], "0"},
     {"0", "0", "0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "2"}]], "0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "1"}]], "0", "0", "0", "0", 
      SubscriptBox["s", 
       RowBox[{"0", ",", "0"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.906783668456521*^9, 3.907052158793269*^9, 
  3.907053723853376*^9, 3.9070537715834227`*^9},
 CellLabel->
  "Out[20]//MatrixForm=",ExpressionUUID->"61dd9760-d2de-4bfe-b572-\
7f6cefb551e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["M", "S"], ".", "Q"}], "-", 
  RowBox[{
   SubscriptBox["M", "Q"], ".", "S"}]}]], "Input",
 CellChangeTimes->{{3.90678367268864*^9, 3.906783684963922*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"617cac5e-acca-44cc-9376-a3d0cc43956d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9067836855278053`*^9, 3.907052158816131*^9, 
  3.907053723877268*^9, 3.907053771605707*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"5616b451-a15c-4796-9e2b-f40008aa460e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Shift", "[", 
   RowBox[{"u_", ",", "v_", ",", "dd_"}], "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"U", "=", "u"}], ",", 
      RowBox[{"V", "=", "v"}], ",", 
      RowBox[{"DD", "=", "dd"}], ",", "monomials", ",", "x", ",", "y", ",", 
      "powers", ",", "NN", ",", "rulematrix", ",", "powermatrix", ",", "R"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"monomials", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x", 
             RowBox[{"j", "-", "i"}]], 
            SuperscriptBox["y", "i"]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "DD"}], "}"}]}], "]"}]}]}], ";", "\n", 
     "    ", 
     RowBox[{"powers", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"j", "-", "i"}], ",", "i"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "j"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", "DD"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NN", " ", "=", 
      RowBox[{"Length", "[", "powers", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rulematrix", " ", "=", " ", 
      RowBox[{"CoefficientRules", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"monomials", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "->", 
            RowBox[{"x", "+", "u"}]}], ",", 
           RowBox[{"y", "->", 
            RowBox[{"y", "+", "v"}]}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"powermatrix", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"powers", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "powers", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\n", "     ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "powers", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"powermatrix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"powermatrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"rulematrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{
       RowBox[{"Transpose", "@", "powermatrix"}], "/.", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "j_"}], "}"}], "->", "0"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "R"}], "}"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.906799087875677*^9, 3.906799146821232*^9}, {
  3.906799210406521*^9, 3.906799326809314*^9}, {3.906799495834881*^9, 
  3.9067995002182417`*^9}, {3.906800870915226*^9, 3.9068008993283567`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"d7411f31-950e-4d89-9763-ec3be46e0fe3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SG", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Shift", "[", 
       RowBox[{"a", ",", "0", ",", "2"}], "]"}], ",", "a"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"a", "->", "0"}], "}"}]}]}], ";", 
  RowBox[{"SG", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.906799647127839*^9, 3.906799659160253*^9}, {
  3.9068001774821787`*^9, 3.906800226341777*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"bf0354a2-05f4-47b2-83f8-c890ecf1bd21"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "2", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "2", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9067996552969847`*^9, 3.9067996595512342`*^9}, {
   3.9068001817615633`*^9, 3.9068002270129423`*^9}, 3.907052158853589*^9, 
   3.907053723914872*^9, 3.907053771637631*^9},
 CellLabel->
  "Out[23]//MatrixForm=",ExpressionUUID->"2d611f03-a372-4eee-a91c-\
134947bc2c26"]
}, Open  ]]
},
WindowSize->{964.5, 528.},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"13.2 for Linux x86 (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ff64aa4c-c2b9-4c74-b047-eb72d935bdb7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 165, 2, 57, "Input",ExpressionUUID->"f320c88e-d8d6-4f4e-9618-487c762222f4"],
Cell[726, 24, 3842, 96, 247, "Input",ExpressionUUID->"53d58c83-074b-4168-bfda-b40f32478424"],
Cell[CellGroupData[{
Cell[4593, 124, 434, 11, 33, "Input",ExpressionUUID->"0479bdf3-0bfc-40ca-9cf6-cdcea6151eaf"],
Cell[5030, 137, 456, 11, 37, "Output",ExpressionUUID->"45a39176-5e52-49c6-9adc-e7c17d0baeca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5523, 153, 485, 12, 33, "Input",ExpressionUUID->"f0003a0c-d71e-454e-9254-bb7311eef858"],
Cell[6011, 167, 454, 11, 37, "Output",ExpressionUUID->"f36ef041-8775-4b64-be9e-74dd9649ca6a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6502, 183, 292, 6, 33, "Input",ExpressionUUID->"7077230e-3bf5-4285-b8a3-36cf0a6abe87"],
Cell[6797, 191, 632, 18, 37, "Output",ExpressionUUID->"62659b74-df7a-4bc5-8153-047657b3ce13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7466, 214, 1126, 22, 36, "Input",ExpressionUUID->"692d97ec-ed31-4fd9-b0f8-13d766036e8d"],
Cell[8595, 238, 1313, 34, 71, "Output",ExpressionUUID->"2cfd4c50-9e04-4633-bf2c-08ebd4fdb136"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9945, 277, 649, 12, 36, "Input",ExpressionUUID->"1d7a7464-2bb5-4331-bad1-b18f36f3fd4f"],
Cell[10597, 291, 2309, 72, 170, "Output",ExpressionUUID->"0aafd088-9ca4-4a6c-833f-9f1cc1c527cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12943, 368, 378, 9, 33, "Input",ExpressionUUID->"8bcfb3d5-3533-4f50-94cd-75aa7642369e"],
Cell[13324, 379, 1741, 56, 92, "Output",ExpressionUUID->"6160cfb0-2807-42bc-ba52-86ddd7837599"]
}, Open  ]],
Cell[15080, 438, 251, 5, 33, "Input",ExpressionUUID->"21d45db0-29ec-4034-8d0c-2b1c3014511d"],
Cell[15334, 445, 5242, 133, 387, "Input",ExpressionUUID->"769c0c50-5a1d-4015-89f8-4f10474249b2"],
Cell[CellGroupData[{
Cell[20601, 582, 1452, 29, 36, "Input",ExpressionUUID->"f344116c-4333-4b95-a7e9-9616553cc8d2"],
Cell[22056, 613, 1764, 30, 37, "Output",ExpressionUUID->"f149123c-7ce4-44ee-9f98-84f026be7944"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23857, 648, 1442, 29, 36, "Input",ExpressionUUID->"bf14ddb5-256c-4b2f-8efc-5a46adeacdd3"],
Cell[25302, 679, 1812, 30, 37, "Output",ExpressionUUID->"01e2ff08-1e4b-46cd-996d-dbf9b13b572c"]
}, Open  ]],
Cell[27129, 712, 540, 10, 33, "Input",ExpressionUUID->"c1bcc6e7-0208-4036-9f2a-ddab39a27848"],
Cell[27672, 724, 3582, 96, 272, "Input",ExpressionUUID->"e87f3aea-7228-4643-b197-31220cd2af8a"],
Cell[CellGroupData[{
Cell[31279, 824, 419, 11, 33, "Input",ExpressionUUID->"3cc4418d-d5d2-4b46-a2ca-88152cef8054"],
Cell[31701, 837, 1278, 29, 227, "Output",ExpressionUUID->"57dd4135-02ce-4074-ac0a-deafc2be7124"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33016, 871, 693, 19, 33, "Input",ExpressionUUID->"d7ffaad1-6a90-4ce6-bafb-cdb4d90cba4a"],
Cell[33712, 892, 790, 23, 44, "Output",ExpressionUUID->"222b9007-0318-4b44-8e74-3d8c389604ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34539, 920, 586, 16, 40, "Input",ExpressionUUID->"bc8982be-f576-4282-a0a8-0359b6ccdd97"],
Cell[35128, 938, 794, 23, 40, "Output",ExpressionUUID->"a79eab05-af76-424f-b6bf-5722963949af"]
}, Open  ]],
Cell[35937, 964, 3660, 98, 332, "Input",ExpressionUUID->"c2dedfd9-c269-4df4-a48b-2c145af22d2f"],
Cell[CellGroupData[{
Cell[39622, 1066, 897, 22, 33, "Input",ExpressionUUID->"85692d06-13e1-455c-bf3f-355fccf9e5a3"],
Cell[40522, 1090, 855, 21, 37, "Output",ExpressionUUID->"6f438dff-c062-4d74-9323-6b1beb5ff0c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41414, 1116, 775, 21, 33, "Input",ExpressionUUID->"04f70a76-38f3-4c45-91fa-405d69412231"],
Cell[42192, 1139, 778, 19, 37, "Output",ExpressionUUID->"8a56feec-1c57-44da-b783-15dede25107a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43007, 1163, 513, 11, 33, "Input",ExpressionUUID->"c9d92738-841c-4f60-ba54-1dae7a0c7eb0"],
Cell[43523, 1176, 4940, 148, 340, "Output",ExpressionUUID->"97e9e831-4a22-40ef-bb2b-99969cf52429"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48500, 1329, 365, 9, 33, "Input",ExpressionUUID->"5e18b2d3-61d2-4d2e-8edf-945b11f8ec0d"],
Cell[48868, 1340, 4791, 145, 340, "Output",ExpressionUUID->"61dd9760-d2de-4bfe-b572-7f6cefb551e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53696, 1490, 285, 7, 33, "Input",ExpressionUUID->"617cac5e-acca-44cc-9376-a3d0cc43956d"],
Cell[53984, 1499, 405, 8, 37, "Output",ExpressionUUID->"5616b451-a15c-4796-9e2b-f40008aa460e"]
}, Open  ]],
Cell[54404, 1510, 3787, 104, 295, "Input",ExpressionUUID->"d7411f31-950e-4d89-9763-ec3be46e0fe3"],
Cell[CellGroupData[{
Cell[58216, 1618, 520, 13, 36, "Input",ExpressionUUID->"bf0354a2-05f4-47b2-83f8-c890ecf1bd21"],
Cell[58739, 1633, 1542, 31, 266, "Output",ExpressionUUID->"2d611f03-a372-4eee-a91c-134947bc2c26"]
}, Open  ]]
}
]
*)

